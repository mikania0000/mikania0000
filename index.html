<!DOCTYPE html>
<html>
<head>
    <title>QR Code Scanner</title>
</head>
<body>
    <h1>QR Code Scanner</h1>
    <p>請使用您的手機QR碼掃描器掃描以下QR碼：</p>
    
    <!-- 嵌入一個空的圖像元素，用於顯示QR碼掃描結果 -->
    <img id="qrCodeResult" src="" alt="QR Code Result">
    
    <!-- JavaScript部分，用於處理QR碼掃描結果 -->
    <script type="text/javascript">
        // 檢查瀏覽器是否支援getUserMedia API
        if ('mediaDevices' in navigator && 'getUserMedia' in navigator.mediaDevices) {
            // 啟動手機的相機
            navigator.mediaDevices.getUserMedia({ video: true })
                .then(function (stream) {
                    // 在圖像元素中顯示相機畫面
                    var video = document.createElement('video');
                    video.srcObject = stream;
                    document.body.appendChild(video);
                    
                    // 創建一個Canvas元素用於繪製QR碼
                    var canvas = document.createElement('canvas');
                    canvas.style.display = 'none';
                    document.body.appendChild(canvas);
                    
                    // 在Canvas上捕獲相機畫面並掃描QR碼
                    var context = canvas.getContext('2d');
                    video.addEventListener('play', function () {
                        canvas.width = video.videoWidth;
                        canvas.height = video.videoHeight;
                        (function loop() {
                            if (!video.paused && !video.ended) {
                                context.drawImage(video, 0, 0, canvas.width, canvas.height);
                                try {
                                    // 使用QR Code掃描庫解析QR碼
                                    qrcode.decode();
                                } catch (error) {
                                    // 如果未檢測到QR碼，繼續下一幀
                                }
                            }
                            requestAnimationFrame(loop);
                        })();
                    });
                    
                    // 設定QR Code掃描庫的回調函數
                    qrcode.callback = function (result) {
                        // 將掃描結果顯示在圖像元素上
                        var qrCodeResult = document.getElementById('qrCodeResult');
                        qrCodeResult.src = result;
                        qrCodeResult.style.display = 'block';
                        
                        // 在這裡可以處理QR碼的結果，例如跳轉到相應的URL
                        // window.location.href = result;
                    };
                })
                .catch(function (error) {
                    console.error('無法訪問相機:', error);
                });
        } else {
            console.error('瀏覽器不支援getUserMedia API');
        }
    </script>
    
    <!-- 引入QR Code掃描庫 -->
    <script type="text/javascript" src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
</body>
</html>
